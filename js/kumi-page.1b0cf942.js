"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[7416],{69690:function(t,e,i){i.d(e,{Z:function(){return l}});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"button-root",on:{click:function(e){return t.$emit("click")}}},[i("i",{class:[t.icon]})])},r=[],s={name:"MyButton1",props:{icon:{default:"el-icon-delete"}}},a=s,c=i(1001),o=(0,c.Z)(a,n,r,!1,null,"a232d95c",null),l=o.exports},80979:function(t,e,i){i.r(e),i.d(e,{default:function(){return Z}});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{attrs:{visible:t.showSelectArtifactDialog,title:"选择圣遗物",width:"80%"},on:{"update:visible":function(e){t.showSelectArtifactDialog=e}}},[i("select-artifact",{attrs:{position:t.selectArtifactPosition},on:{select:t.handleSelectArtifact}})],1),i("div",{staticClass:"m-toolbar hidden-md-and-up"},[i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("span",[i("i",{staticClass:"el-icon-more"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"add"}},[i("i",{staticClass:"el-icon-plus"}),t._v("新建收藏夹")]),i("el-dropdown-item",{attrs:{command:"addKumi"}},[i("i",{staticClass:"el-icon-plus"}),t._v("新建圣遗物组")]),0!==t.currentDirId?i("el-dropdown-item",{attrs:{command:"delete"}},[i("i",{staticClass:"el-icon-delete"}),t._v('删除"'+t._s(t.currentDirTitle)+'"')]):t._e(),0!==t.currentDirId?i("el-dropdown-item",{attrs:{command:"rename"}},[i("i",{staticClass:"el-icon-edit"}),t._v("重命名")]):t._e(),t._l(t.items,(function(e,n){return i("el-dropdown-item",{key:e.index,attrs:{divided:0===n,command:"use "+e.index}},[i("i",{staticClass:"el-icon-menu"}),t._v(t._s(e.title))])}))],2)],1),i("div",{staticClass:"m-middle"},[t._v(" "+t._s(t.currentDirTitle)+" ")])],1),i("div",{staticClass:"pc-container"},[i("div",{staticClass:"left mona-scroll-hidden hidden-sm-and-down"},[i("div",{staticClass:"toolbar"},[i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:t.handleNewDir}},[t._v(" 新建收藏夹 ")])],1),i("div",{staticClass:"mona-scroll-hidden left-list"},[i("my-list",{attrs:{items:t.items},model:{value:t.currentDirId,callback:function(e){t.currentDirId=e},expression:"currentDirId"}})],1)]),i("div",{staticClass:"right mona-scroll-hidden"},[i("div",{staticClass:"hidden-md-and-up"},[i("el-input",{staticStyle:{"margin-bottom":"12px"},attrs:{size:"mini",placeholder:"搜索"},scopedSlots:t._u([{key:"append",fn:function(){return[i("i",{staticClass:"el-icon-search"})]},proxy:!0}]),model:{value:t.searchString,callback:function(e){t.searchString=e},expression:"searchString"}})],1),i("div",{staticClass:"toolbar2 hidden-sm-and-down"},[i("div",{staticClass:"button-left"},[i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:t.handleNewKumi}},[t._v("新建组")]),i("el-input",{staticStyle:{"margin-left":"16px"},attrs:{size:"mini",placeholder:"搜索"},scopedSlots:t._u([{key:"append",fn:function(){return[i("i",{staticClass:"el-icon-search"})]},proxy:!0}]),model:{value:t.searchString,callback:function(e){t.searchString=e},expression:"searchString"}})],1),i("div",{staticClass:"button-right"},[0!==t.currentDirId?i("el-button",{attrs:{size:"mini",type:"danger",title:"删除收藏夹"},on:{click:function(e){return t.handleDeleteDir(t.currentDirId)}}},[i("i",{staticClass:"el-icon-delete"})]):t._e(),0!==t.currentDirId?i("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.handleRenameDir(t.currentDirId)}}},[t._v("重命名")]):t._e()],1)]),i("div",{staticClass:"items mona-scroll-hidden"},[t.filteredKumiList.length>0?i("div",t._l(t.filteredKumiList,(function(e){return i("kumi-item",{key:e.id,attrs:{data:e},on:{delete:function(i){return t.handleDeleteKumi(e.id)},edit:function(i){return t.handleEditKumi(e.id)},click:function(i){return t.handleClickPosition(e.id,i)},deleteArtifact:function(i){return t.handleDeleteArtifact(e.id,i)}}})})),1):i("div",[i("el-empty")],1)])])])],1)},r=[],s=(i(33948),i(74916),i(20629)),a=i(92432),c=i(74221),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",t._l(t.items,(function(e){return i("li",{key:e.index,class:{active:e.index===t.value},on:{click:function(i){return t.$emit("input",e.index)}}},[t._v(" "+t._s(e.title)+" ")])})),0)},l=[],u={name:"MyList",props:["value","items"]},d=u,m=i(1001),f=(0,m.Z)(d,o,l,!1,null,"93c69620",null),h=f.exports,p=i(69690),v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"up"},[i("p",{staticClass:"title"},[t._v(t._s(t.data.title))]),i("div",{staticClass:"buttons"},[i("el-button",{attrs:{type:"text",icon:"el-icon-delete",title:"删除"},on:{click:function(e){return t.$emit("delete")}}}),i("el-button",{attrs:{type:"text",icon:"el-icon-edit",title:"重命名"},on:{click:function(e){return t.$emit("edit")}}})],1)]),i("div",{staticClass:"body"},[t._l(t.positions,(function(e){return[t.artifactBySlot[e]?i("artifact-display",{key:e,staticClass:"artifact-item",attrs:{width:"200px",item:t.artifactBySlot[e],selectable:"",buttons:!0,"lock-button":!1,"delete-button":!0},on:{click:function(i){return t.$emit("click",e)},delete:function(i){return t.$emit("deleteArtifact",t.artifactBySlot[e].id)}}}):i("add-button",{key:e,staticClass:"artifact-item",on:{click:function(i){return t.$emit("click",e)}}})]}))],2)])},k=[],I=i(32032),D=i(92691),y=i(56370),g={name:"KumiItem",components:{AddButton:D.Z,ArtifactDisplay:y.Z},props:["data"],created(){this.positions=I.m7},computed:{...(0,s.Se)("artifacts",["artifactsById"]),artifacts(){let t=[];for(let e of this.data.artifactIds)Object.prototype.hasOwnProperty.call(this.artifactsById,e)&&t.push(this.artifactsById[e]);return t},artifactBySlot(){let t={};for(let e of this.artifacts){const i=e.position;t[i]=e}return t}}},w=g,_=(0,m.Z)(w,v,k,!1,null,"22701bd6",null),C=_.exports,S=i(25925),b={name:"KumiPage",components:{MyButton1:p.Z,MyList:h,KumiItem:C,SelectArtifact:S.Z},data(){return{currentDirId:0,showSelectArtifactDialog:!1,selectArtifactPosition:"flower",underSelectionKumiId:0,searchString:""}},computed:{...(0,s.Se)("kumi",["directories","kumiByDir"]),items(){let t=[];for(let e of this.directories)t.push({index:e.id,title:e.title});return t},currentDirTitle(){for(let t of this.directories)if(t.id===this.currentDirId)return t.title;return""},currentKumiList(){return(0,a.j8)(this.currentDirId)},fuse(){return new c.Z(this.currentKumiList,{keys:["title"]})},filteredKumiList(){if(""===this.searchString)return this.currentKumiList;const t=this.fuse.search(this.searchString);return t.map((t=>t.item))}},watch:{"$store.state.accounts.currentAccountId":{handler(){this.currentDirId=0},immediate:!1}},methods:{handleCommand(t){"add"===t?this.handleNewDir():t.startsWith("use")?this.currentDirId=parseInt(t.split(" ")[1]):"delete"===t?this.handleDeleteDir(this.currentDirId):"rename"===t?this.handleRenameDir(this.currentDirId):"addKumi"===t&&this.handleNewKumi()},handleNewDir(){this.getInputDirName("新建","收藏夹名").then((t=>{(0,a.jq)(t)})).catch(this.handleInputResult)},handleDeleteDir(t){0!==t&&(0,a.P$)(t)},handleRenameDir(t){this.getInputDirName("重命名","新收藏夹名").then((e=>{(0,a.UE)(t,e)})).catch(this.handleInputResult)},handleNewKumi(){this.getInputKumiName("新建","圣遗物组名").then((t=>{(0,a.Ee)(this.currentDirId,t)})).catch(this.handleInputResult)},handleDeleteKumi(t){(0,a.At)(t)},handleEditKumi(t){this.getInputKumiName("重命名","新圣遗物组名").then((e=>{(0,a.UE)(t,e)})).catch(this.handleInputResult)},handleSelectArtifact(t){this.showSelectArtifactDialog=!1,(0,a.JN)(this.underSelectionKumiId,t)},handleDeleteArtifact(t,e){(0,a.fF)(t,e)},handleClickPosition(t,e){this.selectArtifactPosition=e,this.showSelectArtifactDialog=!0,this.underSelectionKumiId=t},handleInputResult(t){t.error&&this.$message.error(t.reason)},getInputKumiName(t,e){return new Promise(((i,n)=>{this.$prompt(null!==e&&void 0!==e?e:"请输入名称",null!==t&&void 0!==t?t:"名称",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((({value:t})=>{const e=(0,a.O5)(this.currentDirId,t);e.error?n({error:!0,reason:e.reason}):i(t)})).catch((()=>{n({error:!1,reason:null})}))}))},getInputDirName(t,e){return new Promise(((i,n)=>{this.$prompt(null!==e&&void 0!==e?e:"请输入名称",null!==t&&void 0!==t?t:"名称",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((({value:t})=>{const e=(0,a.ym)(t);e.error?n({error:!0,reason:e.reason}):i(t)})).catch((()=>{n({error:!1,reason:null})}))}))}}},K=b,x=(0,m.Z)(K,n,r,!1,null,"9675ae58",null),Z=x.exports},92432:function(t,e,i){i.d(e,{At:function(){return h},Ee:function(){return m},GV:function(){return f},JN:function(){return I},O5:function(){return d},P$:function(){return v},UE:function(){return p},fF:function(){return D},fG:function(){return o},j8:function(){return u},jq:function(){return c},wJ:function(){return y},ym:function(){return l}});i(33948);var n=i(24115);function r(){let t=n.Z.getters["kumi/dirNames"];for(let e=0;e<100;e++){const i=`收藏夹${e}`;if(!t.has(i))return i}return`收藏夹${Math.floor(1e5*Math.random())}`}function s(t){const e=u(t);let i=new Set;for(let n of e)i.add(n.title);return i}function a(t){let e=s(t);for(let i=0;i<100;i++){const t=`圣遗物组${i}`;if(!e.has(t))return t}return`圣遗物组${Math.floor(1e5*Math.random())}`}function c(t){const e=null!==t&&void 0!==t?t:r();n.Z.commit("kumi/newDir",{name:e})}function o(t){for(let e of n.Z.getters["kumi/directories"])if(e.title===t)return e.id}function l(t){if(""===t||!t)return{error:!0,reason:"名称为空"};const e=n.Z.getters["kumi/dirNames"];return e.has(t)?{error:!0,reason:"名称已存在"}:{error:!1}}function u(t){const e=n.Z.getters["kumi/kumiByDir"][t];if(!e)return[];const i=n.Z.state.kumi.kumi;let r=[];for(let n of e)r.push(i[n]);return r}function d(t,e){if(""===e||!e)return{error:!0,reason:"名称为空"};let i=s(t);return i.has(e)?{error:!0,reason:"名称已存在"}:{error:!1}}function m(t,e){const i=null!==e&&void 0!==e?e:a(t);n.Z.commit("kumi/newKumi",{artifactIds:[],title:i,dirId:t})}function f(t,e,i){n.Z.commit("kumi/newKumi",{artifactIds:i.slice(),title:e,dirId:t})}function h(t){n.Z.commit("kumi/deleteKumi",{id:t})}function p(t,e){n.Z.commit("kumi/renameItem",{id:t,name:e})}function v(t){n.Z.commit("kumi/deleteDir",{id:t})}function k(t){return n.Z.state.kumi.kumi[t]}function I(t,e){var i;const r=n.Z.getters["artifacts/artifactsById"],s=r[e];if(!s)return;const a=s.position;let c=[e];const o=k(t);if(!o)return;const l=null!==(i=o.artifactIds)&&void 0!==i?i:[];for(let n of l){const t=r[n];t&&t.position===a||c.push(n)}n.Z.commit("kumi/updateKumiArtifact",{artifactIds:c,kumiId:t})}function D(t,e){var i;const r=k(t);if(!r)return;let s=null!==(i=r.artifactIds)&&void 0!==i?i:[],a=s.indexOf(e);-1!==a&&s.splice(a,1),n.Z.commit("kumi/updateKumiArtifact",{artifactIds:s,kumiId:t})}function y(t){var e;const i=k(t);if(!i)return[];let n=null!==(e=i.artifactIds)&&void 0!==e?e:[],r=new Set;for(let s of n)r.add(s);return r}}}]);