"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[659],{5464:function(t,e,i){i.d(e,{Z:function(){return f}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item br-3",on:{click:function(e){return t.$emit("click")}}},[i("div",{staticClass:"header"},[i("span",{staticClass:"fs-12"},[t._v(t._s(t.name))]),t.toolbar?i("div",{staticClass:"buttons flex-row"},[i("el-button",{staticClass:"button",attrs:{icon:"el-icon-delete",type:"text",size:"mini",circle:"",title:"删除"},on:{click:function(e){return e.stopPropagation(),t.$emit("delete")}}}),i("el-button",{staticClass:"button",attrs:{icon:"el-icon-download",type:"text",size:"mini",circle:"",title:"导出"},on:{click:function(e){return e.stopPropagation(),t.$emit("download")}}})],1):t._e()]),i("div",{staticClass:"body"},[i("div",{staticClass:"detail-div fs-12"},[i("img",{staticClass:"c-avatar br-50p",attrs:{src:t.characterAvatar}}),i("span",[t._v(t._s(t.characterChs))])]),i("div",{staticClass:"detail-div fs-12"},[i("img",{staticClass:"w-avatar br-50p",attrs:{src:t.weaponData.url}}),i("span",[t._v(t._s(t.weaponData.chs))])]),i("div",{staticClass:"detail-div fs-12"},[i("img",{staticClass:"tf-avatar br-50p",attrs:{src:t.tfData.badge}}),i("span",[t._v(t._s(t.tfData.chs))])])])])},r=[],a=i(2027),n=i(2961),c=i(778),o={name:"PresetItem",props:{item:{type:Object,required:!0},name:{},toolbar:{type:Boolean,default:!0}},computed:{characterName(){return this.item.character.name},characterAvatar(){const t=a.O[this.characterName];return t.avatar},characterChs(){const t=a.O[this.characterName];return t.chs},weaponData(){return n.G[this.item.weapon.name]},tfData(){return c.F[this.item.targetFunction.name]}}},l=o,u=i(1001),m=(0,u.Z)(l,s,r,!1,null,"49ba95be",null),f=m.exports},4128:function(t,e,i){i.d(e,{Z:function(){return l}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"root",on:{click:function(e){return t.$emit("click")}}},[""!==t.back?i("img",{attrs:{src:t.back}}):t._e(),i("span",{staticClass:"s1"}),i("span",{staticClass:"s2"}),i("span",{staticClass:"s3"}),i("span",{staticClass:"s4"}),t._v(" + ")])},r=[],a={name:"AddButton",props:{back:{default:""}}},n=a,c=i(1001),o=(0,c.Z)(n,s,r,!1,null,"f016431a",null),l=o.exports},6960:function(t,e,i){i.d(e,{Z:function(){return m}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-select",{attrs:{size:"small",value:t.value},on:{input:function(e){return t.$emit("input",e)}}},t._l(t.list,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1)},r=[],a=i(9392),n=(i(3948),i(6250)),c={name:"SelectPreset",props:["value"],computed:(0,a.Z)((0,a.Z)({},(0,n.mapGetters)("presets",["allFlat"])),{},{list(){let t=[];for(let e of this.allFlat)t.push(e.name);return t}})},o=c,l=i(1001),u=(0,l.Z)(o,s,r,!1,null,"0cfb48b7",null),m=u.exports},2285:function(t,e,i){i.r(e),i.d(e,{default:function(){return $}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-drawer",{attrs:{title:"面板",visible:t.showAttributeDrawer,size:t.deviceIsPC?"30%":"100%"},on:{"update:visible":function(e){t.showAttributeDrawer=e}}},[t.wasmAttribute?[i("div",{staticStyle:{padding:"0 20px"}},[i("attribute-panel",{attrs:{attribute:t.wasmAttribute}})],1)]:[i("el-empty",[t._v("In theory, in should not see this")])]],2),i("el-row",{staticStyle:{"margin-bottom":"12px"}},[i("el-col",{attrs:{span:12}},[i("el-button",{attrs:{size:"mini",icon:"el-icon-folder-opened"},on:{click:t.handleClickImportSequence}},[t._v("导入序列")]),i("el-button",{attrs:{size:"mini",icon:"el-icon-folder-checked"},on:{click:t.handleClickSaveSequence}},[t._v("保存序列")]),i("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:t.handleClickAddMember}},[t._v("添加成员")]),i("el-divider",{attrs:{direction:"vertical"}}),i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-cpu"},on:{click:t.handleClickStart}},[t._v("开始计算")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.cancelOptimizeArtifact,expression:"cancelOptimizeArtifact"}],attrs:{type:"danger",size:"mini",icon:"el-icon-warning-outline"},on:{click:t.cancelOptimizeArtifact}},[t._v("中止计算")])],1),i("el-col",{attrs:{span:12}},[i("div",{staticStyle:{float:"right"}},[i("el-button",{attrs:{size:"mini",icon:"el-icon-star-on"},on:{click:t.handleClickSaveToDirectory}},[t._v("批量存至收藏夹")])],1)])],1),t._l(t.presetNames,(function(e,s){return i("el-row",{key:s,attrs:{gutter:16}},[i("el-col",{staticClass:"mona-scroll-hidden left member-item",attrs:{md:6,sm:24}},[i("div",{staticClass:"member-header",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[i("p",{staticClass:"team-title"},[t._v("成员"+t._s(s+1))]),i("div",[i("el-button",{staticStyle:{color:"white"},attrs:{circle:"",size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(e){return t.handleDeleteMember(s)}}})],1)]),i("p",{staticClass:"common-title2"},[t._v("计算预设")]),i("select-preset",{model:{value:t.presetNames[s],callback:function(e){t.$set(t.presetNames,s,e)},expression:"presetNames[index]"}})],1),i("el-col",{ref:"resultCol",refInFor:!0,staticClass:"mona-scroll-hidden right result-item",attrs:{md:18,sm:24}},[i("div",{staticClass:"result-item-top"},[i("div",[i("el-button",{attrs:{icon:"el-icon-s-data",circle:"",size:"mini",type:"text",title:"查看面板"},on:{click:function(e){return t.handleClickDisplayAttributePanel(s)}}})],1),i("div",{staticClass:"result-item-buttons"})]),i("div",{staticClass:"result-item-content"},t._l(t.results[s],(function(e,r){return i("div",{key:e,staticClass:"artifact-item-or-button"},[t.artifactsById[e]?i("artifact-display",{staticClass:"artifact-display",attrs:{item:t.artifactsById[e],selectable:"",buttons:!0,"delete-button":!0},on:{delete:function(e){return t.handleRemoveArtifact(r)},toggle:function(e){return t.handleToggleArtifact(t.id)},click:function(e){return t.handleGotoSelectArtifact(r)}}}):i("add-button",{staticClass:"add-button",staticStyle:{height:"7vw",width:"11vw"},on:{click:function(e){return t.handleGotoSelectArtifact(s)}}})],1)})),0)])],1)}))],2)},r=[],a=i(9392),n=(i(3948),i(6250)),c=i(6436),o=(i(5648),i(8140)),l=i(1580),u=(i(9849),i(8722)),m=i(2027),f=i(8600),p=i(2432),d=i(7451),h=i(1229),b=i(6510),v=i(6370),g=i(9690),_=i(5464),k=i(6960),C=i(8618),y=i(4128),w={name:"SequentialOptimizationPage",components:{SelectCharacter:d.Z,SelectWeapon:h.Z,ItemConfig:b.Z,ArtifactDisplay:v.Z,MyButton1:g.Z,PresetItem:_.Z,SelectPreset:k.Z,AttributePanel:C.Z,AddButton:y.Z},data(){return{presetNames:[],results:[],cancelOptimizeArtifact:null,showAttributeDrawer:!1,wasmAttribute:null,deviceIsPC:u.B}},mounted(){this.handleClickAddMember()},methods:{handleClickAddMember(){this.presetNames.push(null),this.results.push([-1,-1,-1,-1,-1])},handleDeleteMember(t){1!==this.presetNames.length&&(this.$delete(this.presetNames,t),this.$delete(this.results,t))},handleClearResult(){this.results=this.presetNames.map((t=>[-1,-1,-1,-1,-1]))},artifactObjectToArray(t){return[t.flower,t.feather,t.sand,t.goblet,t.head]},async handleClickStart(){const t=this.presets.length===this.presetNames.length;if(t){this.handleClearResult();for(let t=0;t<this.presetNames.length;t++){const i=(0,a.Z)((0,a.Z)({},(0,l.DR)(this.presets[t].item)),{},{max_result_num:1});let s,r=this.$loading({target:this.$refs.resultCol[t].$el,lock:!0,text:"莫娜占卜中"}),[n,c]=(0,o.Y)(i,this.filteredArtifactsWasm);this.cancelOptimizeArtifact=c;try{s=await n}catch(e){this.$message.error(e);break}finally{this.cancelOptimizeArtifact=null,r.close()}0===s.length&&this.$message.error("没有符合条件的圣遗物"),Vue.set(this.results,t,this.artifactObjectToArray(s[0]))}}else this.$message.error("请选择计算预设")},handleClickDisplayAttributePanel:async function(t){this.$message.error("自个儿到计算器看去")},wasmGetAttributeInterface(t){let e=[];if(this.currentResultEntry){const i=Object.values(this.currentResultEntry[t]),s=i.map((t=>this.artifactsById[t])).filter((t=>t));e=s.map((t=>(0,c.Lz)(t)))}return{character:this.presets[t].item.character,weapon:this.presets[t].item.weapon,buffs:this.presets[t].item.buffs,artifacts:e}},getKumiName(t,e){let i={};for(let r of e){let t=this.artifactsById[r];if(!t)continue;const e=t.setName;Object.prototype.hasOwnProperty.call(i,e)||(i[e]=0),i[e]+=1}let s=m.O[t].chs;for(const r in i)i[r]>=2&&(s+="-"+f.oN[r].chs);return s},handleClickSaveToDirectory(){let t=(new Date).toLocaleString();(0,p.jq)(t);let e=(0,p.fG)(t);console.log(e);for(let i=0;i<this.presets.length;i++){let t=this.presets[i].item.character.name,s=this.results[i];(0,p.GV)(e,this.getKumiName(t,s),s)}this.$message.info(`已保存到"${t}"收藏夹`)},handleClickSaveSequence(){this.$store.commit("sequence/save",this.presetNames),this.$message.info("保存序列成功")},handleClickImportSequence(){this.presetNames=this.$store.state.sequence.sequence.slice(),this.handleClearResult()}},computed:(0,a.Z)((0,a.Z)({},(0,n.mapGetters)("artifacts",{artifactsFlat:"allFlat",artifactsById:"artifactsById"})),{},{singleInterfaces(){return this.presets.map((t=>(0,l.DR)(t.item)))},filteredArtifacts(){let t=[];for(let i of this.artifactsFlat)i.level>=16&&t.push(i);let e=new Set;for(let i of this.results)for(let t of i)e.add(t);return t.filter((t=>!t.omit&&!e.has(t.id)))},filteredArtifactsWasm(){return this.filteredArtifacts.map(c.Lz)},presets(){let t=[];for(let e of this.presetNames)e&&t.push((0,l.kE)(e));return t},optimizeTeamHyperParamInterface(){return{mva_step:5,work_space:1e3,max_re_optimize:5,max_search:1e6,count:1e3}},optimizeTeamWasmInterface(){return{single_interfaces:this.singleInterfaces,weights:this.weights,hyper_param:this.optimizeTeamHyperParamInterface}}}),watch:{"$store.state.accounts.currentAccountId"(){this.results=[],this.presetNames=[],this.handleClickAddMember()}}},A=w,Z=i(1001),I=(0,Z.Z)(A,s,r,!1,null,"61855f30",null),$=I.exports},8618:function(t,e,i){i.d(e,{Z:function(){return C}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-row",{attrs:{type:"flex",justify:"space-between"}},[i("el-col",{attrs:{span:11}},[i("h3",{staticClass:"class"},[t._v("基础属性")]),i("attribute-item",{attrs:{title:"生命值",composition:t.attribute.hp}}),i("attribute-item",{attrs:{title:"攻击力",composition:t.attribute.atk}}),i("attribute-item",{attrs:{title:"防御力",composition:t.attribute.def}}),i("attribute-item",{attrs:{title:"元素精通",composition:t.attribute.elemental_mastery}}),i("h3",{staticClass:"class"},[t._v("进阶属性")]),i("attribute-item",{attrs:{title:"暴击率",composition:t.attribute.critical,percentage:!0}}),i("attribute-item",{attrs:{title:"暴击伤害",composition:t.attribute.critical_damage,percentage:!0}}),i("attribute-item",{attrs:{title:"治疗加成",composition:t.attribute.healing_bonus,percentage:!0}}),i("attribute-item",{attrs:{title:"元素充能效率",composition:t.attribute.recharge,percentage:!0}}),i("attribute-item",{attrs:{title:"护盾强效",composition:t.attribute.shield_strength,percentage:!0}})],1),i("el-col",{attrs:{span:11}},[i("h3",{staticClass:"class"},[t._v("元素属性")]),i("attribute-item",{attrs:{title:"火元素伤害加成",composition:t.attribute.bonus_pyro,percentage:!0}}),i("attribute-item",{attrs:{title:"水元素伤害加成",composition:t.attribute.bonus_hydro,percentage:!0}}),i("attribute-item",{attrs:{title:"草元素伤害加成",composition:t.attribute.bonus_dendro,percentage:!0}}),i("attribute-item",{attrs:{title:"雷元素伤害加成",composition:t.attribute.bonus_electro,percentage:!0}}),i("attribute-item",{attrs:{title:"风元素伤害加成",composition:t.attribute.bonus_anemo,percentage:!0}}),i("attribute-item",{attrs:{title:"冰元素伤害加成",composition:t.attribute.bonus_cryo,percentage:!0}}),i("attribute-item",{attrs:{title:"岩元素伤害加成",composition:t.attribute.bonus_geo,percentage:!0}}),i("attribute-item",{attrs:{title:"物理伤害加成",composition:t.attribute.bonus_physical,percentage:!0}})],1)],1)],1)},r=[],a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"attribute-item"},[i("el-tooltip",[i("span",{staticClass:"title"},[t._v(t._s(t.title))]),i("div",{attrs:{slot:"content"},slot:"content"},[i("attribute-composition",{attrs:{composition:t.composition}})],1)]),i("span",{staticClass:"value"},[t._v(t._s(t.displayValue))])],1)},n=[],c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.list.length>0?t._l(t.list,(function(e){return i("div",{key:e.name,staticClass:"item"},[i("span",[t._v(t._s(e.name))]),i("span",[t._v(t._s(e.value.toFixed(3)))])])})):i("div",{staticClass:"no-item",staticStyle:{padding:"8px"}},[t._v(" 无加成 ")])],2)},o=[],l=(i(2707),{name:"AttributeComposition",props:["composition"],computed:{list(){let t=[];for(const e in this.composition)t.push({name:e,value:this.composition[e]});return t.sort(((t,e)=>t.name.localeCompare(e.name))),t}}}),u=l,m=i(1001),f=(0,m.Z)(u,c,o,!1,null,"a1776db8",null),p=f.exports,d={name:"AttributeItem",components:{AttributeComposition:p},props:{composition:{},title:{},percentage:{default:!1}},computed:{sum(){let t=0;for(const e in this.composition)t+=this.composition[e];return t},displayValue(){return this.percentage?`${(100*this.sum).toFixed(1)}%`:Math.round(this.sum)}}},h=d,b=(0,m.Z)(h,a,n,!1,null,"4722bde2",null),v=b.exports,g={name:"AttributePanel",components:{AttributeItem:v},props:{attribute:{type:Object}},methods:{mul100(t){return(100*this.attribute[t]).toFixed(1)+"%"}},computed:{attack(){let t=this.attribute;return t.attackStatic+t.attackBasic+t.attackPercentage},defend(){let t=this.attribute;return t.defendStatic+t.defendBasic+t.defendPercentage},life(){let t=this.attribute;return t.lifeStatic+t.lifeBasic+t.lifePercentage}}},_=g,k=(0,m.Z)(_,s,r,!1,null,"6a339b15",null),C=k.exports},2432:function(t,e,i){i.d(e,{At:function(){return d},Ee:function(){return f},GV:function(){return p},JN:function(){return g},O5:function(){return m},P$:function(){return b},UE:function(){return h},fF:function(){return _},fG:function(){return o},j8:function(){return u},jq:function(){return c},wJ:function(){return k},ym:function(){return l}});i(3948);var s=i(4115);function r(){let t=s.Z.getters["kumi/dirNames"];for(let e=0;e<100;e++){const i=`收藏夹${e}`;if(!t.has(i))return i}return`收藏夹${Math.floor(1e5*Math.random())}`}function a(t){const e=u(t);let i=new Set;for(let s of e)i.add(s.title);return i}function n(t){let e=a(t);for(let i=0;i<100;i++){const t=`圣遗物组${i}`;if(!e.has(t))return t}return`圣遗物组${Math.floor(1e5*Math.random())}`}function c(t){const e=null!==t&&void 0!==t?t:r();s.Z.commit("kumi/newDir",{name:e})}function o(t){for(let e of s.Z.getters["kumi/directories"])if(e.title===t)return e.id}function l(t){if(""===t||!t)return{error:!0,reason:"名称为空"};const e=s.Z.getters["kumi/dirNames"];return e.has(t)?{error:!0,reason:"名称已存在"}:{error:!1}}function u(t){const e=s.Z.getters["kumi/kumiByDir"][t];if(!e)return[];const i=s.Z.state.kumi.kumi;let r=[];for(let s of e)r.push(i[s]);return r}function m(t,e){if(""===e||!e)return{error:!0,reason:"名称为空"};let i=a(t);return i.has(e)?{error:!0,reason:"名称已存在"}:{error:!1}}function f(t,e){const i=null!==e&&void 0!==e?e:n(t);s.Z.commit("kumi/newKumi",{artifactIds:[],title:i,dirId:t})}function p(t,e,i){s.Z.commit("kumi/newKumi",{artifactIds:i,title:e,dirId:t})}function d(t){s.Z.commit("kumi/deleteKumi",{id:t})}function h(t,e){s.Z.commit("kumi/renameItem",{id:t,name:e})}function b(t){s.Z.commit("kumi/deleteDir",{id:t})}function v(t){return s.Z.state.kumi.kumi[t]}function g(t,e){var i;const r=s.Z.getters["artifacts/artifactsById"],a=r[e];if(!a)return;const n=a.position;let c=[e];const o=v(t);if(!o)return;const l=null!==(i=o.artifactIds)&&void 0!==i?i:[];for(let s of l){const t=r[s];t&&t.position===n||c.push(s)}s.Z.commit("kumi/updateKumiArtifact",{artifactIds:c,kumiId:t})}function _(t,e){var i;const r=v(t);if(!r)return;let a=null!==(i=r.artifactIds)&&void 0!==i?i:[],n=a.indexOf(e);-1!==n&&a.splice(n,1),s.Z.commit("kumi/updateKumiArtifact",{artifactIds:a,kumiId:t})}function k(t){var e;const i=v(t);if(!i)return[];let s=null!==(e=i.artifactIds)&&void 0!==e?e:[],r=new Set;for(let a of s)r.add(a);return r}}}]);