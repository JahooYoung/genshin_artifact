(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[7726],{66005:function(t,e,a){"use strict";a.d(e,{Z:function(){return h}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item br-3",on:{click:function(e){return t.$emit("click")}}},[a("div",{staticClass:"header"},[a("span",{staticClass:"fs-12"},[t._v(t._s(t.name))]),t.toolbar?a("div",{staticClass:"buttons flex-row"},[t.calculateIcon?a("el-button",{staticClass:"button",attrs:{icon:"el-icon-cpu",type:"text",size:"mini",circle:"",title:"快速计算"},on:{click:function(e){return e.stopPropagation(),t.$emit("cpu")}}}):t._e(),a("el-button",{staticClass:"button",attrs:{icon:"el-icon-delete",type:"text",size:"mini",circle:"",title:"删除"},on:{click:function(e){return e.stopPropagation(),t.$emit("delete")}}}),a("el-button",{staticClass:"button",attrs:{icon:"el-icon-download",type:"text",size:"mini",circle:"",title:"导出"},on:{click:function(e){return e.stopPropagation(),t.$emit("download")}}})],1):t._e()]),a("div",{staticClass:"body"},[a("div",{staticClass:"detail-div fs-12"},[a("img",{staticClass:"c-avatar br-50p",attrs:{src:t.characterAvatar}}),a("span",[t._v(t._s(t.characterChs))])]),a("div",{staticClass:"detail-div fs-12"},[a("img",{staticClass:"w-avatar br-50p",attrs:{src:t.weaponData.url}}),a("span",[t._v(t._s(t.weaponData.chs))])]),a("div",{staticClass:"detail-div fs-12"},[a("img",{staticClass:"tf-avatar br-50p",attrs:{src:t.tfData.badge}}),a("span",[t._v(t._s(t.tfData.chs))])])])])},i=[],s=a(22027),n=a(62961),l=a(40778),c={name:"PresetItem",props:{item:{type:Object,required:!0},name:{},toolbar:{type:Boolean,default:!0},calculateIcon:{default:!0}},computed:{characterName(){return this.item.character.name},characterAvatar(){const t=s.O[this.characterName];return t.avatar},characterChs(){const t=s.O[this.characterName];return t.chs},weaponData(){return n.G[this.item.weapon.name]},tfData(){return l.F[this.item.targetFunction.name]}}},o=c,u=a(1001),f=(0,u.Z)(o,r,i,!1,null,"f90acbca",null),h=f.exports},53674:function(t,e,a){"use strict";a.d(e,{Z:function(){return o}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{ref:"rootBox",staticClass:"root",class:{over:t.isDragOver},on:{dragenter:t.handleDragEnter,dragleave:t.handleDragLeave,dragover:t.handleDragover,drop:t.handleDrop,click:t.handleClick}},[t._m(0)]),t.hasFile?a("p",{staticClass:"filename"},[t._v(t._s(t.fileName))]):t._e(),a("input",{ref:"fileInput",staticClass:"file-input",attrs:{type:"file"},on:{change:t.handleSelectFile}})])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"center-div"},[a("i",{staticClass:"el-icon-upload"}),a("span",[t._v("点击，或拖拽上传")])])}],s={name:"ImportBlock",mounted(){this.file=null},data(){return{isDragOver:!1,hasFile:!1,fileName:""}},methods:{handleDrop(t){t.preventDefault(),this.isDragOver=!1;let e=null;if(t.dataTransfer.items){for(let a=0;a<t.dataTransfer.items.length;a++)if("file"===t.dataTransfer.items[a].kind){e=t.dataTransfer.items[a].getAsFile();break}}else e=t.dataTransfer.files[0].name;this.file=e,e&&(this.hasFile=!0,this.fileName=e.name)},getReadPromise(){return new Promise(((t,e)=>{this.file||e("未选择文件");try{let a=new FileReader;a.onload=e=>{t(e.target.result)},a.onerror=t=>{e(t)},a.readAsText(this.file)}catch(a){e(a)}}))},handleDragEnter(t){t.preventDefault(),this.isDragOver=!0},handleDragLeave(t){t.preventDefault(),this.isDragOver=!1},handleDragover(t){t.preventDefault()},handleClick(){const t=this.$refs["fileInput"];t&&t.click()},handleSelectFile(t){const e=this.$refs["fileInput"];if(!e)return;const a=Array.from(e.files);a.length>0&&(this.file=a[0],this.hasFile=!0,this.fileName=a[0].name)}}},n=s,l=a(1001),c=(0,l.Z)(n,r,i,!1,null,"d75e0f8c",null),o=c.exports},53671:function(t,e,a){var r=a(17854),i=a(19662),s=a(47908),n=a(68361),l=a(26244),c=r.TypeError,o=function(t){return function(e,a,r,o){i(a);var u=s(e),f=n(u),h=l(u),d=t?h-1:0,p=t?-1:1;if(r<2)while(1){if(d in f){o=f[d],d+=p;break}if(d+=p,t?d<0:h<=d)throw c("Reduce of empty array with no initial value")}for(;t?d>=0:h>d;d+=p)d in f&&(o=a(o,f[d],d,u));return o}};t.exports={left:o(!1),right:o(!0)}},85827:function(t,e,a){"use strict";var r=a(82109),i=a(53671).left,s=a(9341),n=a(7392),l=a(35268),c=s("reduce"),o=!l&&n>79&&n<83;r({target:"Array",proto:!0,forced:!c||o},{reduce:function(t){var e=arguments.length;return i(this,t,e,e>1?arguments[1]:void 0)}})},33434:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return C}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{visible:t.showImportDialog,title:"导入",width:"60%"},on:{"update:visible":function(e){t.showImportDialog=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("el-button",{on:{click:function(e){t.showImportDialog=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleImport}},[t._v("确定")])]},proxy:!0}])},[a("import-block",{ref:"importBlock"})],1),a("el-drawer",{attrs:{visible:t.showArtifactsScoreDrawer,title:"推荐圣遗物",size:t.deviceIsPC?"30%":"100%"},on:{"update:visible":function(e){t.showArtifactsScoreDrawer=e}}},[0===t.artifactScoreList.length?a("el-empty"):a("div",{staticClass:"artifact-score-list-div"},t._l(t.artifactsScoreListCut,(function(e,r){return a("div",{key:r},[a("artifact-display",{staticClass:"artifact-score-item",attrs:{item:t.artifactsById[e[0]],"show-back":!0,"back-value":e[1]}})],1)})),0)],1),a("div",{staticClass:"toolbar"},[a("el-button",{attrs:{icon:"el-icon-download",size:"mini"},on:{click:t.handleExportAll}},[t._v("导出全部")]),a("el-button",{attrs:{icon:"el-icon-upload2",size:"mini"},on:{click:t.handleClickImport}},[t._v("导入")])],1),t.presetsLength>0?a("div",{staticClass:"body"},t._l(t.allFlat,(function(e){return a("preset-item",{key:e.name,staticClass:"item",attrs:{item:e.item,name:e.name},on:{delete:function(a){return t.handleDeletePreset(e.name)},download:function(a){return t.handleDownload(e.name)},cpu:function(a){return t.handleQuickCalculate(e.name)},click:function(a){return t.test(e.name)}}})})),1):[a("el-empty",[a("p",{staticStyle:{"font-size":"0.9em",color:"#606266"}},[t._v(" 请前往"),a("span",{staticClass:"route-item",on:{click:function(e){return t.$router.replace("/calculate")}}},[t._v("计算器")]),t._v("页面添加预设 ")])])]],2)},i=[],s=(a(33948),a(38862),a(85827),a(20629)),n=a(1580),l=a(49024),c=a(76436),o=a(15648),u=a(8722),f=a(66005),h=a(53674),d=a(56370),p={name:"CharacterPresetsPage",components:{PresetItem:f.Z,ImportBlock:h.Z,ArtifactDisplay:d.Z},created(){},data(){return{showImportDialog:!1,showArtifactsScoreDrawer:!1,artifactScoreList:[],deviceIsPC:u.B}},methods:{checkImportType(t){return Object.prototype.hasOwnProperty.call(t,"data")?"multi":"single"},handleQuickCalculate(t){this.$router.push({name:"calculate",params:{presetName:t}})},async handleImport(){const t=this.$refs.importBlock;if(!t)return;const e=await t.getReadPromise();let a=null;try{a=JSON.parse(e)}catch(i){a=null}const r=(0,n.mf)(a);if(r){for(let t of a)(0,n.y0)(t.item,t.name);this.showImportDialog=!1}else this.$message.error("导入格式错误")},handleDeletePreset(t){(0,n.UK)(t)},handleDownload(t){const e=(0,n.kE)(t),a=[e],r=JSON.stringify(a);(0,l.Qz)(r,"text/plain",t)},handleExportAll(){const t=JSON.stringify(this.allFlat);(0,l.Qz)(t,"text/plain","预设")},handleClickImport(){this.showImportDialog=!0},test(t){console.log(t);const e=(0,n.kE)(t).item;if(!e)return;const a=e.character,r=e.weapon,i=e.targetFunction,s=this.allArtifactsFlat.map((t=>(0,c.Lz)(t)));(0,o.eH)(a,r,i,s).then((t=>{t=t.filter((t=>0===this.artifactsById[t[0]].level)),this.artifactScoreList=t;const e=t.map((t=>t[1])).reduce(((t,e)=>Math.max(t,e)),0);if(console.log(e),e>0)for(let a=0;a<t.length;a++)t[a][1]/=e;this.showArtifactsScoreDrawer=!0}))}},computed:{...(0,s.Se)("presets",["allFlat"]),...(0,s.Se)("artifacts",{allArtifactsFlat:"allFlat",artifactsById:"artifactsById"}),presetsLength(){return this.allFlat.length},artifactsScoreListCut(){return this.artifactScoreList.slice(0,20)}}},m=p,v=a(1001),g=(0,v.Z)(m,r,i,!1,null,"9c29f120",null),C=g.exports}}]);