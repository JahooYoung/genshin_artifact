"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[659],{2691:function(t,e,i){i.d(e,{Z:function(){return o}});var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"root",on:{click:function(e){return t.$emit("click")}}},[""!==t.back?i("img",{attrs:{src:t.back}}):t._e(),i("span",{staticClass:"s1"}),i("span",{staticClass:"s2"}),i("span",{staticClass:"s3"}),i("span",{staticClass:"s4"}),t._v(" "+t._s(t.msg)+" ")])},s=[],l={name:"AddButton",props:{back:{default:""},msg:{default:"+"}}},r=l,n=i(1001),c=(0,n.Z)(r,a,s,!1,null,"459e5e0e",null),o=c.exports},5925:function(t,e,i){i.d(e,{Z:function(){return p}});var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"filters"},[i("select-artifact-main-stat",{attrs:{placeholder:"主词条"},model:{value:t.filterMainTag,callback:function(e){t.filterMainTag=e},expression:"filterMainTag"}}),i("select-artifact-set",{attrs:{"any-option":"",placeholder:"套装"},model:{value:t.filterArtifactSetName,callback:function(e){t.filterArtifactSetName=e},expression:"filterArtifactSetName"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.artifactListDisplayed.length>0,expression:"artifactListDisplayed.length > 0"}],staticClass:"artifacts"},t._l(t.artifactListDisplayed,(function(e){return i("artifact-display",{key:e.id,attrs:{item:e,selectable:""},on:{click:function(i){return t.$emit("select",e.id)}}})})),1),i("div",{directives:[{name:"show",rawName:"v-show",value:0===t.artifactListDisplayed.length,expression:"artifactListDisplayed.length === 0"}],staticClass:"no-artifacts"},[i("el-empty")],1),i("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,total:t.artifactList.length,layout:"prev, pager, next",small:!t.deviceIsPC},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)},s=[],l=(i(3948),i(8722)),r=i(4182),n=i(4797),c=i(6370);const o=20;var u={name:"SelectArtifact",components:{SelectArtifactMainStat:r.Z,SelectArtifactSet:n.Z,ArtifactDisplay:c.Z},props:{position:{}},created(){this.pageSize=o},data(){return{filterMainTag:"any",filterArtifactSetName:"any",currentPage:1,deviceIsPC:l.B}},computed:{artifactListUnfiltered(){if("any"===this.position)return this.$store.getters["artifacts/allFlat"];const t=this.$store.state.artifacts[this.position];return t},artifactList(){let t=[];for(let e of this.artifactListUnfiltered)"any"!==this.filterMainTag&&this.filterMainTag!==e.mainTag.name||"any"!==this.filterArtifactSetName&&this.filterArtifactSetName!==e.setName||t.push(e);return t},artifactListDisplayed(){const t=(this.currentPage-1)*o,e=Math.min(t+o,this.artifactList.length);return this.artifactList.slice(t,e)}}},f=u,d=i(1001),h=(0,d.Z)(f,a,s,!1,null,"655ebd7b",null),p=h.exports},4182:function(t,e,i){i.d(e,{Z:function(){return u}});var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-select",{attrs:{value:t.value,size:"small",multiple:t.multiple,placeholder:t.placeholder},on:{input:function(e){return t.$emit("input",e)}}},[t.includeAny?i("el-option",{attrs:{label:"任意",value:"any"}}):t._e(),t._l(t.tagList,(function(t){return i("el-option",{key:t.name,attrs:{label:t.title,value:t.name}})}))],2)},s=[],l=(i(3948),i(2032)),r={name:"SelectArtifactMainStat",props:{value:{},includeAny:{default:!0},multiple:{default:!1},position:{default:null},placeholder:{type:String,default:"请选择"}},computed:{tagList(){let t=[];if(this.position)for(let e of l.nl[this.position])t.push({name:e,title:l.vB[e].chs});else for(let e in l.vB)t.push({name:e,title:l.vB[e].chs});return t}}},n=r,c=i(1001),o=(0,c.Z)(n,a,s,!1,null,null,null),u=o.exports},4797:function(t,e,i){i.d(e,{Z:function(){return h}});var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-select",{attrs:{value:t.value,disabled:t.disabled,size:"small",multiple:t.multiple,"multiple-limit":t.multipleLimit,placeholder:t.placeholder},on:{input:function(e){return t.$emit("input",e)}}},[t.anyOption?i("el-option",{attrs:{label:"任意",value:"any"}}):t._e(),t._l(t.allArtifactsName,(function(e){return i("el-option",{key:e.name,attrs:{label:e.chs,value:e.name}},[i("div",{staticClass:"item"},[i("img",{staticClass:"tn",attrs:{src:e.url}}),i("span",[t._v(t._s(e.chs))])])])}))],2)},s=[],l=(i(2707),i(8600)),r=i(7267);let n=Object.values(l.oN);n.sort(((t,e)=>e.maxStar-t.maxStar));let c=n.map((t=>({name:t.eng,chs:t.chs,url:(0,r.Lk)(t.eng)})));var o={name:"SelectArtifactSet",created:function(){this.allArtifactsName=c},props:{value:{type:String|Array,required:!0},disabled:{type:Boolean,default:!1},anyOption:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},multipleLimit:{default:2},placeholder:{type:String,default:"请选择"}}},u=o,f=i(1001),d=(0,f.Z)(u,a,s,!1,null,"ee44e4fe",null),h=d.exports},6960:function(t,e,i){i.d(e,{Z:function(){return u}});var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-select",{attrs:{size:"small",value:t.value},on:{input:function(e){return t.$emit("input",e)}}},t._l(t.list,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1)},s=[],l=(i(3948),i(6250)),r={name:"SelectPreset",props:["value"],computed:{...(0,l.mapGetters)("presets",["allFlat"]),list(){let t=[];for(let e of this.allFlat)t.push(e.name);return t}}},n=r,c=i(1001),o=(0,c.Z)(n,a,s,!1,null,"0cfb48b7",null),u=o.exports},2226:function(t,e,i){i.r(e),i.d(e,{default:function(){return z}});var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("apply-preset-dialog",{ref:"applyPresetDialog",on:{selected:function(e){return t.addPreset(e)}}}),i("el-dialog",{attrs:{title:"选择圣遗物",width:t.deviceIsPC?"80%":"90%",visible:t.showSelectArtifactDialog},on:{"update:visible":function(e){t.showSelectArtifactDialog=e}}},[i("select-artifact",{attrs:{position:t.selectArtifactSlot},on:{select:t.handleSelectArtifact}})],1),i("el-row",{staticStyle:{"margin-bottom":"12px"}},[i("el-col",{attrs:{span:12}},[i("el-button",{attrs:{size:"mini",icon:"el-icon-folder-opened"},on:{click:t.handleClickImportSequence}},[t._v("导入序列")]),i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-folder-checked",disabled:!t.sequenceDirty},on:{click:t.handleClickSaveSequence}},[t._v("保存序列")]),i("el-divider",{attrs:{direction:"vertical"}}),t.cancelOptimizeArtifact?t._e():i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-cpu"},on:{click:function(e){return t.handleStartCompute(0)}}},[t._v("开始计算")]),t.cancelOptimizeArtifact?i("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-warning-outline"},on:{click:t.cancelOptimizeArtifact}},[t._v("中止计算")]):t._e()],1),i("el-col",{attrs:{span:12}},[i("div",{staticStyle:{float:"right"}},[i("el-button",{attrs:{size:"mini",icon:"el-icon-star-on"},on:{click:t.handleClickSaveToDirectory}},[t._v("批量存至收藏夹")])],1)])],1),i("transition-group",{attrs:{name:"flip-list",tag:"div"}},[t._l(t.presets,(function(e,a){return i("el-row",{key:e.name,staticClass:"flip-list-item",attrs:{gutter:16}},[i("el-col",{staticClass:"mona-scroll-hidden left member-item",attrs:{md:6,sm:24}},[i("div",{staticClass:"member-header",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[i("p",{staticClass:"team-title"},[t._v("成员"+t._s(a+1))]),i("div",[i("el-button",{staticStyle:{color:"white"},attrs:{circle:"",size:"mini",type:"text",icon:"el-icon-arrow-up",disabled:0===a},on:{click:function(e){return t.handleUpMember(a)}}}),i("el-button",{staticStyle:{color:"white"},attrs:{circle:"",size:"mini",type:"text",icon:"el-icon-arrow-down",disabled:a===t.presetNames.length-1},on:{click:function(e){return t.handleDownMember(a)}}}),i("el-button",{staticStyle:{color:"white"},attrs:{circle:"",size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(e){return t.handleDeleteMember(a)}}})],1)]),i("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[i("preset-item",{staticStyle:{width:"100%"},attrs:{toolbar:!1,item:e.item,name:e.name}})],1)]),i("el-col",{staticClass:"mona-scroll-hidden right result-item",attrs:{md:18,sm:24,id:t.presetNamesAndId[a][1]}},[i("div",{staticClass:"result-item-top"},[i("div",[i("el-button",{attrs:{size:"mini",icon:"el-icon-view"},on:{click:function(e){return t.handleRedirectToCalculator(a)}}},[t._v("角色详情")]),i("el-button",{attrs:{size:"mini",icon:"el-icon-smoking"},on:{click:function(e){return t.handleStartCompute(a,a+1)}}},[t._v("计算这个")]),i("el-button",{attrs:{size:"mini",icon:"el-icon-caret-bottom"},on:{click:function(e){return t.handleStartCompute(a)}}},[t._v("计算这个及以下")])],1),i("div",{staticClass:"result-item-buttons"})]),i("div",{staticClass:"result-item-content"},t._l(t.results[a],(function(e,s){return i("div",{key:s,staticClass:"artifact-item-or-button"},[t.artifactsById[e]?i("artifact-display",{staticClass:"artifact-display",attrs:{item:t.artifactsById[e],selectable:"",buttons:!0,"delete-button":!0},on:{delete:function(e){return t.handleRemoveArtifact(a,s)},toggle:function(i){return t.handleToggleArtifact(e)},click:function(e){return t.handleGotoSelectArtifact(a,s)}}}):i("add-button",{staticClass:"add-button",staticStyle:{height:"7vw",width:"11vw"},on:{click:function(e){return t.handleGotoSelectArtifact(a,s)}}})],1)})),0)])],1)})),i("el-row",{key:"this-is-a-unique-key-for-add-button!!!!",staticClass:"flip-list-item",attrs:{gutter:16}},[i("el-col",{staticClass:"mona-scroll-hidden left member-item",attrs:{md:6,sm:24}},[i("add-button",{staticStyle:{height:"7vw",width:"100%"},attrs:{msg:"添加成员"},on:{click:function(e){return t.$refs.applyPresetDialog.open()}}})],1)],1)],2)],1)},s=[],l=(i(3948),i(6250)),r=i(705),n=i.n(r),c=i(6436),o=i(8140),u=i(1580),f=(i(9849),i(8722)),d=i(2027),h=i(8600),p=i(2432),m=i(7451),g=i(1434),v=i(6510),y=i(6370),b=i(9690),S=i(6005),A=i(6960),w=i(8618),k=i(2691),C=i(3686),_=i(5925),N={name:"SequentialOptimizationPage",components:{SelectCharacter:m.Z,SelectWeapon:g.Z,ItemConfig:v.Z,ArtifactDisplay:y.Z,MyButton1:b.Z,PresetItem:S.Z,SelectPreset:A.Z,AttributePanel:w.Z,AddButton:k.Z,ApplyPresetDialog:C.Z,SelectArtifact:_.Z},data(){return{presetNamesAndId:[],results:[],showSelectArtifactDialog:!1,selectArtifactSlot:"any",handleSelectArtifact:null,cancelOptimizeArtifact:null,showAttributeDrawer:!1,wasmAttribute:null,deviceIsPC:f.B,savedSequenceHash:null}},computed:{...(0,l.mapGetters)("artifacts",{artifactsFlat:"allFlat",artifactsById:"artifactsById"}),singleInterfaces(){return this.presets.map((t=>(0,u.DR)(t.item)))},presetNames(){return this.presetNamesAndId.map((([t,e])=>t))},presets(){return this.presetNames.map((t=>(0,u.kE)(t)))},sequenceDirty(){const t=n()(this.presetNames);return t!==this.savedSequenceHash}},watch:{"$store.state.accounts.currentAccountId"(){this.presetNameAndId=[],this.results=[]}},methods:{genUniqueId(){return"arts"+String(Math.floor(1e8*Math.random()))},addPreset(t){this.presetNamesAndId.push([t,this.genUniqueId()]),this.results.push([-1,-1,-1,-1,-1])},swap(t,e,i){let a=t[e];this.$set(t,e,t[i]),this.$set(t,i,a)},handleUpMember(t){this.swap(this.presetNamesAndId,t,t-1),this.swap(this.results,t,t-1)},handleDownMember(t){this.swap(this.presetNamesAndId,t,t+1),this.swap(this.results,t,t+1)},handleDeleteMember(t){this.$delete(this.presetNamesAndId,t),this.$delete(this.results,t)},artifactObjectToArray(t){return[t.flower,t.feather,t.sand,t.goblet,t.head]},getFilteredArtifactsWasm(t){let e=[];for(let a of this.artifactsFlat)a.level>=16&&e.push(a);let i=new Set;for(let a of t)for(let t of a)i.add(t);return e.filter((t=>!t.omit&&!i.has(t.id))).map(c.Lz)},async handleStartCompute(t,e){void 0===e&&(e=this.presets.length);const i=this.presets.slice(t,e).every((t=>t));if(i){for(let i=t;i<e;i++)this.$set(this.results,i,[-1,-1,-1,-1,-1]);for(let i=t;i<e;i++){const t={...(0,u.DR)(this.presets[i].item),max_result_num:1};let e,s=this.$loading({target:"#"+this.presetNamesAndId[i][1],lock:!0,text:"莫娜占卜中"}),l=this.getFilteredArtifactsWasm(this.results.slice(0,i)),[r,n]=(0,o.Y)(t,l);this.cancelOptimizeArtifact=n;try{e=await r}catch(a){this.$message.error(a);break}finally{this.cancelOptimizeArtifact=null,s.close()}0===e.length&&this.$message.error("没有符合条件的圣遗物"),this.$set(this.results,i,this.artifactObjectToArray(e[0]))}}else this.$message.error("计算范围内有计算预设已被删除")},wasmGetAttributeInterface(t){let e=[];if(this.currentResultEntry){const i=Object.values(this.currentResultEntry[t]),a=i.map((t=>this.artifactsById[t])).filter((t=>t));e=a.map((t=>(0,c.Lz)(t)))}return{character:this.presets[t].item.character,weapon:this.presets[t].item.weapon,buffs:this.presets[t].item.buffs,artifacts:e}},getKumiName(t,e){let i={};for(let s of e){let t=this.artifactsById[s];if(!t)continue;const e=t.setName;Object.prototype.hasOwnProperty.call(i,e)||(i[e]=0),i[e]+=1}let a=d.O[t].chs;for(const s in i)i[s]>=2&&(a+="-"+h.oN[s].chs);return a},handleClickSaveToDirectory(){let t=(new Date).toLocaleString();(0,p.jq)(t);let e=(0,p.fG)(t);console.log(e);for(let i=0;i<this.presets.length;i++){let t=this.presets[i].item.character.name,a=this.results[i];(0,p.GV)(e,this.getKumiName(t,a),a)}this.$message.info(`已保存到"${t}"收藏夹`)},handleClickSaveSequence(){this.$store.commit("sequence/save",this.presetNames),this.savedSequenceHash=n()(this.presetNames),this.$message.info("保存序列成功")},handleClickImportSequence(){let t=this.$store.state.sequence.sequence.slice();this.presetNamesAndId=t.map((t=>[t,this.genUniqueId()])),this.savedSequenceHash=n()(this.presetNames),this.results=this.presetNames.map((t=>[-1,-1,-1,-1,-1]))},handleRedirectToCalculator(t){this.$router.push({name:"calculate",params:{presetName:this.presetNames[t],artifacts:this.results[t]}})},handleRemoveArtifact(t,e){this.$set(this.results[t],e,-1)},handleToggleArtifact(t){this.$store.commit("artifacts/toggleById",{id:t})},handleGotoSelectArtifact(t,e){const i=["flower","feather","sand","cup","head"],a=i[e];this.selectArtifactSlot=a,this.handleSelectArtifact=i=>{this.$set(this.results[t],e,i),this.showSelectArtifactDialog=!1},this.showSelectArtifactDialog=!0}}},$=N,I=i(1001),D=(0,I.Z)($,a,s,!1,null,"14717336",null),z=D.exports}}]);