"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[726],{37632:function(t,e,a){a.d(e,{Z:function(){return d}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item br-3",on:{click:function(e){return t.$emit("click")}}},[a("div",{staticClass:"header"},[a("span",{staticClass:"fs-12"},[t._v(t._s(t.name))]),t.toolbar?a("div",{staticClass:"buttons flex-row"},[a("el-button",{staticClass:"button",attrs:{icon:"el-icon-delete",type:"text",size:"mini",circle:"",title:"删除"},on:{click:function(e){return e.stopPropagation(),t.$emit("delete")}}}),a("el-button",{staticClass:"button",attrs:{icon:"el-icon-download",type:"text",size:"mini",circle:"",title:"导出"},on:{click:function(e){return e.stopPropagation(),t.$emit("download")}}})],1):t._e()]),a("div",{staticClass:"body"},[a("div",{staticClass:"detail-div fs-12"},[a("img",{staticClass:"c-avatar br-50p",attrs:{src:t.characterAvatar}}),a("span",[t._v(t._s(t.characterChs))])]),a("div",{staticClass:"detail-div fs-12"},[a("img",{staticClass:"w-avatar br-50p",attrs:{src:t.weaponData.url}}),a("span",[t._v(t._s(t.weaponData.chs))])]),a("div",{staticClass:"detail-div fs-12"},[a("img",{staticClass:"tf-avatar br-50p",attrs:{src:t.tfData.badge}}),a("span",[t._v(t._s(t.tfData.chs))])])])])},n=[],i=(a(68309),a(12637)),s=a(51775),l=a(43073),c={name:"PresetItem",props:{item:{type:Object,required:!0},name:{},toolbar:{type:Boolean,default:!0}},computed:{characterName:function(){return this.item.character.name},characterAvatar:function(){var t=i.O[this.characterName];return t.avatar},characterChs:function(){var t=i.O[this.characterName];return t.chs},weaponData:function(){return s.G[this.item.weapon.name]},tfData:function(){return l.F[this.item.targetFunction.name]}}},o=c,u=a(1001),f=(0,u.Z)(o,r,n,!1,null,"49ba95be",null),d=f.exports},46499:function(t,e,a){a.d(e,{Z:function(){return o}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{ref:"rootBox",staticClass:"root",class:{over:t.isDragOver},on:{dragenter:t.handleDragEnter,dragleave:t.handleDragLeave,dragover:t.handleDragover,drop:t.handleDrop,click:t.handleClick}},[t._m(0)]),t.hasFile?a("p",{staticClass:"filename"},[t._v(t._s(t.fileName))]):t._e(),a("input",{ref:"fileInput",staticClass:"file-input",attrs:{type:"file"},on:{change:t.handleSelectFile}})])},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"center-div"},[a("i",{staticClass:"el-icon-upload"}),a("span",[t._v("点击，或拖拽上传")])])}],i=(a(68309),a(41539),a(91038),a(78783),{name:"ImportBlock",mounted:function(){this.file=null},data:function(){return{isDragOver:!1,hasFile:!1,fileName:""}},methods:{handleDrop:function(t){t.preventDefault(),this.isDragOver=!1;var e=null;if(t.dataTransfer.items){for(var a=0;a<t.dataTransfer.items.length;a++)if("file"===t.dataTransfer.items[a].kind){e=t.dataTransfer.items[a].getAsFile();break}}else e=t.dataTransfer.files[0].name;this.file=e,e&&(this.hasFile=!0,this.fileName=e.name)},getReadPromise:function(){var t=this;return new Promise((function(e,a){t.file||a("未选择文件");try{var r=new FileReader;r.onload=function(t){e(t.target.result)},r.onerror=function(t){a(t)},r.readAsText(t.file)}catch(n){a(n)}}))},handleDragEnter:function(t){t.preventDefault(),this.isDragOver=!0},handleDragLeave:function(t){t.preventDefault(),this.isDragOver=!1},handleDragover:function(t){t.preventDefault()},handleClick:function(){var t=this.$refs["fileInput"];t&&t.click()},handleSelectFile:function(t){var e=this.$refs["fileInput"];if(e){var a=Array.from(e.files);a.length>0&&(this.file=a[0],this.hasFile=!0,this.fileName=a[0].name)}}}}),s=i,l=a(1001),c=(0,l.Z)(s,r,n,!1,null,"d75e0f8c",null),o=c.exports},2706:function(t,e,a){a.r(e),a.d(e,{default:function(){return C}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{visible:t.showImportDialog,title:"导入",width:"60%"},on:{"update:visible":function(e){t.showImportDialog=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("el-button",{on:{click:function(e){t.showImportDialog=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleImport}},[t._v("确定")])]},proxy:!0}])},[a("import-block",{ref:"importBlock"})],1),a("el-drawer",{attrs:{visible:t.showArtifactsScoreDrawer,title:"推荐圣遗物",size:t.deviceIsPC?"30%":"100%"},on:{"update:visible":function(e){t.showArtifactsScoreDrawer=e}}},[0===t.artifactScoreList.length?a("el-empty"):a("div",{staticClass:"artifact-score-list-div"},t._l(t.artifactsScoreListCut,(function(e,r){return a("div",{key:r},[a("artifact-display",{staticClass:"artifact-score-item",attrs:{item:t.artifactsById[e[0]],"show-back":!0,"back-value":e[1]}})],1)})),0)],1),a("div",{staticClass:"toolbar"},[a("el-button",{attrs:{icon:"el-icon-download",size:"mini"},on:{click:t.handleExportAll}},[t._v("导出全部")]),a("el-button",{attrs:{icon:"el-icon-upload2",size:"mini"},on:{click:t.handleClickImport}},[t._v("导入")])],1),t.presetsLength>0?a("div",{staticClass:"body"},t._l(t.allFlat,(function(e){return a("preset-item",{key:e.name,staticClass:"item",attrs:{item:e.item,name:e.name},on:{delete:function(a){return t.handleDeletePreset(e.name)},download:function(a){return t.handleDownload(e.name)},click:function(a){return t.test(e.name)}}})})),1):[a("el-empty",[a("p",{staticStyle:{"font-size":"0.9em",color:"#606266"}},[t._v(" 请前往"),a("span",{staticClass:"route-item",on:{click:function(e){return t.$router.replace("/calculate")}}},[t._v("计算器")]),t._v("页面添加预设 ")])])]],2)},n=[],i=a(4367),s=a(62032),l=a(16198),c=(a(35666),a(68309),a(38862),a(21249),a(57327),a(41539),a(47042),a(26294)),o=a(39285),u=a(76711),f=a(65735),d=a(64273),h=a(60058),m=a(37632),p=a(46499),v=a(65010),g={name:"CharacterPresetsPage",components:{PresetItem:m.Z,ImportBlock:p.Z,ArtifactDisplay:v.Z},created:function(){},data:function(){return{showImportDialog:!1,showArtifactsScoreDrawer:!1,artifactScoreList:[],deviceIsPC:h.B}},methods:{checkImportType:function(t){return Object.prototype.hasOwnProperty.call(t,"data")?"multi":"single"},handleImport:function(){var t=this;return(0,l.Z)(regeneratorRuntime.mark((function e(){var a,r,n,i,l,c,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.$refs.importBlock,a){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,a.getReadPromise();case 5:r=e.sent,n=null;try{n=JSON.parse(r)}catch(f){n=null}if(i=(0,o.mf)(n),i){l=(0,s.Z)(n);try{for(l.s();!(c=l.n()).done;)u=c.value,(0,o.y0)(u.item,u.name)}catch(d){l.e(d)}finally{l.f()}t.showImportDialog=!1}else t.$message.error("导入格式错误");case 10:case"end":return e.stop()}}),e)})))()},handleDeletePreset:function(t){(0,o.UK)(t)},handleDownload:function(t){var e=(0,o.kE)(t),a=[e],r=JSON.stringify(a);(0,u.Qz)(r,"text/plain",t)},handleExportAll:function(){var t=JSON.stringify(this.allFlat);(0,u.Qz)(t,"text/plain","预设")},handleClickImport:function(){this.showImportDialog=!0},test:function(t){var e=this;console.log(t);var a=(0,o.kE)(t).item;if(a){var r=a.character,n=a.weapon,i=a.targetFunction,s=this.allArtifactsFlat.map((function(t){return(0,f.Lz)(t)}));(0,d.eH)(r,n,i,s).then((function(t){t=t.filter((function(t){return 0===e.artifactsById[t[0]].level})),e.artifactScoreList=t;var a=t.map((function(t){return t[1]})).reduce((function(t,e){return Math.max(t,e)}),0);if(console.log(a),a>0)for(var r=0;r<t.length;r++)t[r][1]/=a;e.showArtifactsScoreDrawer=!0}))}}},computed:(0,i.Z)((0,i.Z)((0,i.Z)({},(0,c.mapGetters)("presets",["allFlat"])),(0,c.mapGetters)("artifacts",{allArtifactsFlat:"allFlat",artifactsById:"artifactsById"})),{},{presetsLength:function(){return this.allFlat.length},artifactsScoreListCut:function(){return this.artifactScoreList.slice(0,20)}})},w=g,D=a(1001),k=(0,D.Z)(w,r,n,!1,null,"76de68cd",null),C=k.exports}}]);