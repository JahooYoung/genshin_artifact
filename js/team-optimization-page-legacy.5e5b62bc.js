"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[121],{48823:function(t,e,n){n.r(e),n.d(e,{default:function(){return N}});var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-breadcrumb",[n("el-breadcrumb-item",[t._v("全队配装")])],1),n("el-divider"),n("el-drawer",{attrs:{title:"面板",visible:t.showAttributeDrawer},on:{"update:visible":function(e){t.showAttributeDrawer=e}}},[t.wasmAttribute?[n("div",{staticStyle:{padding:"0 20px"}},[n("attribute-panel",{attrs:{attribute:t.wasmAttribute}})],1)]:[n("el-empty",[t._v("In theory, in should not see this")])]],2),n("el-row",{attrs:{gutter:16}},[n("el-col",{ref:"content",staticClass:"mona-scroll",style:{height:t.contentHeight},attrs:{span:6}},[n("div",[n("my-button1",{attrs:{icon:"el-icon-caret-right",title:"开始计算"},on:{click:t.handleClickStart}}),n("my-button1",{attrs:{icon:"el-icon-plus",title:"添加成员"},on:{click:t.handleClickAddMember}})],1),t._l(t.presetNames,(function(e,s){return n("div",{key:s,staticClass:"member-item"},[n("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[n("p",{staticClass:"team-title"},[t._v("成员"+t._s(s+1))]),n("div",[n("el-button",{attrs:{circle:"",size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(e){return t.handleDeleteMember(s)}}})],1)]),n("p",{staticClass:"common-title2"},[t._v("计算预设")]),n("select-preset",{model:{value:t.presetNames[s],callback:function(e){t.$set(t.presetNames,s,e)},expression:"presetNames[index]"}}),n("p",{staticClass:"common-title2"},[t._v("权重")]),n("el-slider",{staticStyle:{"padding-left":"8px"},attrs:{min:0,max:1,step:.01,"show-input":!0},model:{value:t.weights[s],callback:function(e){t.$set(t.weights,s,e)},expression:"weights[index]"}}),s<t.presetNames.length-1?n("el-divider"):t._e()],1)}))],2),n("el-col",{staticClass:"mona-scroll",style:{height:t.contentHeight},attrs:{span:18}},[t.currentResultEntry?[n("el-input-number",{staticStyle:{"margin-bottom":"12px"},attrs:{value:t.resultIndex+1,min:1,max:t.results.length,size:"small"},on:{input:t.handleChangeResultIndex}}),t._l(t.currentResultEntry,(function(e,s){return n("div",{key:s,staticClass:"result-item"},[n("div",{staticClass:"result-item-top"},[n("div",[n("el-button",{attrs:{icon:"el-icon-s-data",circle:"",size:"mini",type:"text",title:"查看面板"},on:{click:function(e){return t.handleClickDisplayAttributePanel(s)}}})],1),n("div",{staticClass:"result-item-buttons"})]),n("div",{staticClass:"result-item-content"},t._l(t.currentResultEntry[s],(function(e){return n("artifact-display",{key:e,attrs:{item:t.artifactsById[e],buttons:!0,"lock-button":!0,"delete-button":!1,"edit-button":!1},on:{toggle:function(n){return t.handleToggleArtifact(e)}}})})),1)])}))]:[n("div",{staticStyle:{display:"flex","justify-content":"center"}},[n("el-empty")],1)]],2)],1)],1)},i=[],r=n(62032),a=n(4367),l=n(16198),c=(n(35666),n(41539),n(26833),n(57327),n(21249),n(26294)),u=n(65735),o=n(64273),h=n(39285),f=(n(42246),n(67828)),m=(n(76711),n(63655)),p=n(16746),d=n(77921),v=n(24044),g=n(89415),y=n(98806),b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-select",{attrs:{size:"small",value:t.value},on:{input:function(e){return t.$emit("input",e)}}},t._l(t.list,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)},w=[],x=(n(68309),{name:"SelectPreset",props:["value"],computed:(0,a.Z)((0,a.Z)({},(0,c.mapGetters)("presets",["allFlat"])),{},{list:function(){var t,e=[],n=(0,r.Z)(this.allFlat);try{for(n.s();!(t=n.n()).done;){var s=t.value;e.push(s.name)}}catch(i){n.e(i)}finally{n.f()}return e}})}),k=x,I=n(1001),A=(0,I.Z)(k,b,w,!1,null,"0cfb48b7",null),C=A.exports,_=n(96581),Z={name:"TeamOptimizationPage",components:{SelectCharacter:m.Z,SelectWeapon:p.Z,ItemConfig:d.Z,ArtifactDisplay:v.Z,MyButton1:g.Z,PresetItem:y.Z,SelectPreset:C,AttributePanel:_.Z},data:function(){return{results:[],resultIndex:0,contentHeight:"",presetNames:[null],weights:[],showAttributeDrawer:!1,wasmAttribute:null}},mounted:function(){var t=this,e=this.$refs["content"];this.$nextTick((function(){var n=e.$el.getBoundingClientRect();t.contentHeight="calc(100vh - ".concat(n.top,"px)")}))},methods:{handleClickAddMember:function(){8!==this.presetNames.length?(this.presetNames.push(null),this.weights.push(0)):this.$message.error("最多支持8个成员")},handleDeleteMember:function(t){1!==this.presetNames.length&&(this.$delete(this.presetNames,t),this.$delete(this.weights,t))},handleClickStart:function(){var t=this,e=this.presets.length===this.presetNames.length;if(e){var n=this.optimizeTeamWasmInterface,s=this.filteredArtifactsWasm,i=this.$loading({lock:!0,text:"莫娜占卜中（可能需要数分钟）"});(0,o.YK)(n,s).then((function(e){t.results=e.artifacts,t.resultIndex=0})).catch((function(t){console.log(t)})).finally((function(){i.close()}))}else this.$message.error("请选择计算预设")},handleChangeResultIndex:function(t){this.resultIndex=t-1},handleClickDisplayAttributePanel:function(){var t=(0,l.Z)(regeneratorRuntime.mark((function t(e){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.wasmGetAttributeInterface(e),t.next=3,(0,o.le)(n);case 3:s=t.sent,this.wasmAttribute=s,this.showAttributeDrawer=!0;case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),wasmGetAttributeInterface:function(t){var e=this,n=[];if(this.currentResultEntry){var s=Object.values(this.currentResultEntry[t]),i=s.map((function(t){return e.artifactsById[t]})).filter((function(t){return t}));n=i.map((function(t){return(0,u.Lz)(t)}))}return{character:this.presets[t].item.character,weapon:this.presets[t].item.weapon,buffs:this.presets[t].item.buffs,artifacts:n}},handleClickSaveAsKumi:function(t){var e=this;if(this.currentResultEntry){var n=Object.values(this.currentResultEntry[t]);n.map((function(t){return e.artifactsById[t]})).filter((function(t){return t}))}},handleToggleArtifact:function(t){(0,f.kY)(t)}},computed:(0,a.Z)((0,a.Z)({},(0,c.mapGetters)("artifacts",{artifactsFlat:"allFlat",artifactsById:"artifactsById"})),{},{singleInterfaces:function(){return this.presets.map((function(t){return(0,h.DR)(t.item)}))},currentResultEntry:function(){return 0===this.results.length?null:this.results[this.resultIndex]},filteredArtifacts:function(){var t,e=[],n=(0,r.Z)(this.artifactsFlat);try{for(n.s();!(t=n.n()).done;){var s=t.value;s.level>=16&&e.push(s)}}catch(i){n.e(i)}finally{n.f()}return e.filter((function(t){return!t.omit}))},filteredArtifactsWasm:function(){return this.filteredArtifacts.map(u.Lz)},presets:function(){var t,e=[],n=(0,r.Z)(this.presetNames);try{for(n.s();!(t=n.n()).done;){var s=t.value;s&&e.push((0,h.kE)(s))}}catch(i){n.e(i)}finally{n.f()}return e},optimizeTeamHyperParamInterface:function(){return{mva_step:5,work_space:1e3,max_re_optimize:5,max_search:1e6,count:1e3}},optimizeTeamWasmInterface:function(){return{single_interfaces:this.singleInterfaces,weights:this.weights,hyper_param:this.optimizeTeamHyperParamInterface}}}),watch:{"$store.state.accounts.currentAccountId":function(){this.results=[],this.resultIndex=0,this.presetNames=[null],this.weights=[]}}},R=Z,$=(0,I.Z)(R,s,i,!1,null,"20cea6de",null),N=$.exports}}]);