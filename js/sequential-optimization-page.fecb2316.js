"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[659],{2691:function(t,e,s){s.d(e,{Z:function(){return o}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"root",on:{click:function(e){return t.$emit("click")}}},[""!==t.back?s("img",{attrs:{src:t.back}}):t._e(),s("span",{staticClass:"s1"}),s("span",{staticClass:"s2"}),s("span",{staticClass:"s3"}),s("span",{staticClass:"s4"}),t._v(" "+t._s(t.msg)+" ")])},a=[],r={name:"AddButton",props:{back:{default:""},msg:{default:"+"}}},l=r,n=s(1001),c=(0,n.Z)(l,i,a,!1,null,"459e5e0e",null),o=c.exports},6960:function(t,e,s){s.d(e,{Z:function(){return u}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-select",{attrs:{size:"small",value:t.value},on:{input:function(e){return t.$emit("input",e)}}},t._l(t.list,(function(t){return s("el-option",{key:t,attrs:{label:t,value:t}})})),1)},a=[],r=(s(3948),s(6250)),l={name:"SelectPreset",props:["value"],computed:{...(0,r.mapGetters)("presets",["allFlat"]),list(){let t=[];for(let e of this.allFlat)t.push(e.name);return t}}},n=l,c=s(1001),o=(0,c.Z)(n,i,a,!1,null,"0cfb48b7",null),u=o.exports},3238:function(t,e,s){s.r(e),s.d(e,{default:function(){return q}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("apply-preset-dialog",{ref:"applyPresetDialog",on:{selected:function(e){return t.addPreset(e)}}}),s("el-row",{staticStyle:{"margin-bottom":"12px"}},[s("el-col",{attrs:{span:12}},[s("el-button",{attrs:{size:"mini",icon:"el-icon-folder-opened"},on:{click:t.handleClickImportSequence}},[t._v("导入序列")]),s("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-folder-checked",disabled:!t.sequenceDirty},on:{click:t.handleClickSaveSequence}},[t._v("保存序列")]),s("el-divider",{attrs:{direction:"vertical"}}),t.cancelOptimizeArtifact?t._e():s("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-cpu"},on:{click:t.handleClickStart}},[t._v("开始计算")]),t.cancelOptimizeArtifact?s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-warning-outline"},on:{click:t.cancelOptimizeArtifact}},[t._v("中止计算")]):t._e()],1),s("el-col",{attrs:{span:12}},[s("div",{staticStyle:{float:"right"}},[s("el-button",{attrs:{size:"mini",icon:"el-icon-star-on"},on:{click:t.handleClickSaveToDirectory}},[t._v("批量存至收藏夹")])],1)])],1),s("transition-group",{attrs:{name:"flip-list",tag:"div"}},[t._l(t.presets,(function(e,i){return s("el-row",{key:e.name,staticClass:"flip-list-item",attrs:{gutter:16}},[s("el-col",{staticClass:"mona-scroll-hidden left member-item",attrs:{md:6,sm:24}},[s("div",{staticClass:"member-header",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[s("p",{staticClass:"team-title"},[t._v("成员"+t._s(i+1))]),s("div",[s("el-button",{staticStyle:{color:"white"},attrs:{circle:"",size:"mini",type:"text",icon:"el-icon-arrow-up",disabled:0===i},on:{click:function(e){return t.handleUpMember(i)}}}),s("el-button",{staticStyle:{color:"white"},attrs:{circle:"",size:"mini",type:"text",icon:"el-icon-arrow-down",disabled:i===t.presetNames.length-1},on:{click:function(e){return t.handleDownMember(i)}}}),s("el-button",{staticStyle:{color:"white"},attrs:{circle:"",size:"mini",type:"text",icon:"el-icon-delete",disabled:1===t.presetNames.length},on:{click:function(e){return t.handleDeleteMember(i)}}})],1)]),s("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[s("preset-item",{staticStyle:{width:"100%"},attrs:{toolbar:!1,item:e.item,name:e.name}})],1)]),s("el-col",{ref:"resultCol",refInFor:!0,staticClass:"mona-scroll-hidden right result-item",attrs:{md:18,sm:24}},[s("div",{staticClass:"result-item-top"},[s("div",[s("el-button",{attrs:{icon:"el-icon-cpu",circle:"",size:"mini",type:"text",title:"转到计算器"},on:{click:function(e){return t.handleRedirectToCalculator(i)}}})],1),s("div",{staticClass:"result-item-buttons"})]),s("div",{staticClass:"result-item-content"},t._l(t.results[i],(function(e,i){return s("div",{key:i,staticClass:"artifact-item-or-button"},[t.artifactsById[e]?s("artifact-display",{staticClass:"artifact-display",attrs:{item:t.artifactsById[e],selectable:"",buttons:!0,"delete-button":!0}}):s("add-button",{staticClass:"add-button",staticStyle:{height:"7vw",width:"11vw"},attrs:{msg:""}})],1)})),0)])],1)})),s("el-row",{key:"this-is-a-unique-key-for-add-button!!!!",staticClass:"flip-list-item",attrs:{gutter:16}},[s("el-col",{staticClass:"mona-scroll-hidden left member-item",attrs:{md:6,sm:24}},[s("add-button",{staticStyle:{height:"7vw",width:"100%"},attrs:{msg:"添加成员"},on:{click:function(e){return t.$refs.applyPresetDialog.open()}}})],1)],1)],2)],1)},a=[],r=(s(3948),s(6250)),l=s(705),n=s.n(l),c=s(6436),o=s(8140),u=s(1580),h=(s(9849),s(8722)),m=s(2027),p=s(8600),d=s(2432),f=s(7451),b=s(1434),y=s(6510),v=s(6370),g=s(9690),w=s(6005),C=s(6960),k=s(8618),S=s(2691),_=s(3686),$={name:"SequentialOptimizationPage",components:{SelectCharacter:f.Z,SelectWeapon:b.Z,ItemConfig:y.Z,ArtifactDisplay:v.Z,MyButton1:g.Z,PresetItem:w.Z,SelectPreset:C.Z,AttributePanel:k.Z,AddButton:S.Z,ApplyPresetDialog:_.Z},data(){return{presetNames:[],results:[],cancelOptimizeArtifact:null,showAttributeDrawer:!1,wasmAttribute:null,deviceIsPC:h.B,savedSequenceHash:null}},methods:{addPreset(t){this.presetNames.push(t),this.results.push([-1,-1,-1,-1,-1])},swap(t,e,s){let i=t[e];this.$set(t,e,t[s]),this.$set(t,s,i)},handleUpMember(t){this.swap(this.presetNames,t,t-1),this.swap(this.results,t,t-1)},handleDownMember(t){this.swap(this.presetNames,t,t+1),this.swap(this.results,t,t+1)},handleDeleteMember(t){this.$delete(this.presetNames,t),this.$delete(this.results,t)},handleClearResult(){this.results=this.presetNames.map((t=>[-1,-1,-1,-1,-1]))},artifactObjectToArray(t){return[t.flower,t.feather,t.sand,t.goblet,t.head]},async handleClickStart(){const t=this.presets.every((t=>t));if(t){this.handleClearResult();for(let t=0;t<this.presetNames.length;t++){const s={...(0,u.DR)(this.presets[t].item),max_result_num:1};let i,a=this.$loading({target:this.$refs.resultCol[t].$el,lock:!0,text:"莫娜占卜中"}),[r,l]=(0,o.Y)(s,this.filteredArtifactsWasm);this.cancelOptimizeArtifact=l;try{i=await r}catch(e){this.$message.error(e);break}finally{this.cancelOptimizeArtifact=null,a.close()}0===i.length&&this.$message.error("没有符合条件的圣遗物"),this.$set(this.results,t,this.artifactObjectToArray(i[0]))}}else this.$message.error("有计算预设已被删除")},wasmGetAttributeInterface(t){let e=[];if(this.currentResultEntry){const s=Object.values(this.currentResultEntry[t]),i=s.map((t=>this.artifactsById[t])).filter((t=>t));e=i.map((t=>(0,c.Lz)(t)))}return{character:this.presets[t].item.character,weapon:this.presets[t].item.weapon,buffs:this.presets[t].item.buffs,artifacts:e}},getKumiName(t,e){let s={};for(let a of e){let t=this.artifactsById[a];if(!t)continue;const e=t.setName;Object.prototype.hasOwnProperty.call(s,e)||(s[e]=0),s[e]+=1}let i=m.O[t].chs;for(const a in s)s[a]>=2&&(i+="-"+p.oN[a].chs);return i},handleClickSaveToDirectory(){let t=(new Date).toLocaleString();(0,d.jq)(t);let e=(0,d.fG)(t);console.log(e);for(let s=0;s<this.presets.length;s++){let t=this.presets[s].item.character.name,i=this.results[s];(0,d.GV)(e,this.getKumiName(t,i),i)}this.$message.info(`已保存到"${t}"收藏夹`)},handleClickSaveSequence(){this.$store.commit("sequence/save",this.presetNames),this.savedSequenceHash=n()(this.presetNames),this.$message.info("保存序列成功")},handleClickImportSequence(){this.presetNames=this.$store.state.sequence.sequence.slice(),this.savedSequenceHash=n()(this.presetNames),this.handleClearResult()},handleRedirectToCalculator(t){this.$router.push({name:"calculate",params:{presetName:this.presetNames[t],artifacts:this.results[t]}})}},computed:{...(0,r.mapGetters)("artifacts",{artifactsFlat:"allFlat",artifactsById:"artifactsById"}),singleInterfaces(){return this.presets.map((t=>(0,u.DR)(t.item)))},filteredArtifacts(){let t=[];for(let s of this.artifactsFlat)s.level>=16&&t.push(s);let e=new Set;for(let s of this.results)for(let t of s)e.add(t);return t.filter((t=>!t.omit&&!e.has(t.id)))},filteredArtifactsWasm(){return this.filteredArtifacts.map(c.Lz)},presets(){return this.presetNames.map((t=>(0,u.kE)(t)))},sequenceDirty(){const t=n()(this.presetNames);return t!==this.savedSequenceHash}},watch:{"$store.state.accounts.currentAccountId"(){this.results=[],this.presetNames=[],this.handleClickAddMember()}}},A=$,N=s(1001),z=(0,N.Z)(A,i,a,!1,null,"2ff3298e",null),q=z.exports}}]);